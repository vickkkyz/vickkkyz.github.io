

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <!-- é€šè¿‡cdnå¼•å…¥éœé¹­æ–‡æ¥·å­—ä½“ -->
  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print"
    onload="this.media='all'">
  <link rel="apple-touch-icon" sizes="76x76" href="/image/beautify/favicon.ico">
  <link rel="icon" href="/image/beautify/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Vickkkyz">
  <meta name="keywords" content="">
  
    <meta name="description" content="1.çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ« è¿›ç¨‹åŸºæœ¬ä¸Šç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œçº¿ç¨‹å­˜åœ¨äºè¿›ç¨‹å†…ï¼Œæ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå­é›† çº¿ç¨‹é€šä¿¡ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºå®ƒä»¬å…±äº«è¿›ç¨‹å†…çš„å†…å­˜ï¼Œä¸€ä¸ªä¾‹å­æ˜¯å¤šä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå…±äº«å˜é‡ çº¿ç¨‹æ›´è½»é‡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ä¸€èˆ¬ä¸Šè¦æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä½  2.å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•è¿™æ˜¯Threadç±»ä¸­çš„run()æ–¹æ³• 12345public void run() &amp;#123;        if (this.target !&#x3D; n">
<meta property="og:type" content="article">
<meta property="og:title" content="Javaå¤šçº¿ç¨‹-çº¿ç¨‹æ ¸å¿ƒåŸºç¡€">
<meta property="og:url" content="https://vickkkyz.fun/2022/03/24/Java/JUC/%E7%BA%BF%E7%A8%8B%E5%85%AB%E5%A4%A7%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Vickkkyz&#39;s Home">
<meta property="og:description" content="1.çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ« è¿›ç¨‹åŸºæœ¬ä¸Šç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œçº¿ç¨‹å­˜åœ¨äºè¿›ç¨‹å†…ï¼Œæ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå­é›† çº¿ç¨‹é€šä¿¡ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºå®ƒä»¬å…±äº«è¿›ç¨‹å†…çš„å†…å­˜ï¼Œä¸€ä¸ªä¾‹å­æ˜¯å¤šä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå…±äº«å˜é‡ çº¿ç¨‹æ›´è½»é‡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ä¸€èˆ¬ä¸Šè¦æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä½  2.å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•è¿™æ˜¯Threadç±»ä¸­çš„run()æ–¹æ³• 12345public void run() &amp;#123;        if (this.target !&#x3D; n">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/1.png">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/2.png">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/3.png">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/4.png">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/waitSet.png">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/6.png">
<meta property="og:image" content="https://vickkkyz.fun/image/juc/thread.png">
<meta property="article:published_time" content="2022-03-24T12:33:22.000Z">
<meta property="article:modified_time" content="2023-01-26T08:48:17.765Z">
<meta property="article:author" content="Vickkkyz">
<meta property="article:tag" content="æ€»ç»“">
<meta property="article:tag" content="juc">
<meta property="article:tag" content="å¹¶å‘ç¼–ç¨‹">
<meta property="article:tag" content="çº¿ç¨‹">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://vickkkyz.fun/image/juc/1.png">
  
  
  
  <title>Javaå¤šçº¿ç¨‹-çº¿ç¨‹æ ¸å¿ƒåŸºç¡€ - Vickkkyz&#39;s Home</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/cloudedGlass.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"vickkkyz.fun","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"ğŸ­","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/image/beautify/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <!--æµè§ˆå™¨æç¬‘æ ‡é¢˜-->
  <script type="text/javascript" src="\js\FunnyTitle.js"></script>

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Vickkkyzã®Blog(*/Ï‰ï¼¼*)</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>æ—¶é—´è½´</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äºæˆ‘</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/image/homePage/paperDefault5.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.2)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Javaå¤šçº¿ç¨‹-çº¿ç¨‹æ ¸å¿ƒåŸºç¡€"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-03-24 20:33" pubdate>
          2022å¹´3æœˆ24æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.6k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          55 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Javaå¤šçº¿ç¨‹-çº¿ç¨‹æ ¸å¿ƒåŸºç¡€</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="1-çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«"><a href="#1-çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«" class="headerlink" title="1.çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«"></a>1.çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«</h1><ul>
<li>è¿›ç¨‹åŸºæœ¬ä¸Šç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œçº¿ç¨‹å­˜åœ¨äºè¿›ç¨‹å†…ï¼Œæ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå­é›†</li>
<li>çº¿ç¨‹é€šä¿¡ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºå®ƒä»¬å…±äº«è¿›ç¨‹å†…çš„å†…å­˜ï¼Œä¸€ä¸ªä¾‹å­æ˜¯å¤šä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®åŒä¸€ä¸ªå…±äº«å˜é‡</li>
<li>çº¿ç¨‹æ›´è½»é‡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ä¸€èˆ¬ä¸Šè¦æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä½</li>
</ul>
<h1 id="2-å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•"><a href="#2-å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•" class="headerlink" title="2.å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•"></a>2.å®ç°å¤šçº¿ç¨‹çš„æ–¹æ³•</h1><p><font color='blue'>è¿™æ˜¯Threadç±»ä¸­çš„run()æ–¹æ³•</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.target != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-built_in">this</span>.target.run();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>ä¸‹é¢ä¸¤ä¸ªåˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•éƒ½æ˜¯</p>
<h2 id="2-1-å®ç°Runnableæ¥å£"><a href="#2-1-å®ç°Runnableæ¥å£" class="headerlink" title="2.1 å®ç°Runnableæ¥å£"></a>2.1 å®ç°Runnableæ¥å£</h2><p>å®ç°Runnbaleæ¥å£ï¼Œå¿…é¡»é‡å†™run()æ–¹æ³•ï¼Œåœ¨runæ–¹æ³•ä¸­å®šä¹‰éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚ç„¶ååˆ›å»ºä¸€ä¸ªThreadç±»ï¼Œå°†å®ç°ç±»ä¼ è¿›å»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RunnableStyle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ã€ç”¨Runnableï¼Œçº¿ç¨‹è¢«åˆ›å»º....ã€‘&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RunnableStyle</span>());<br>        thread.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœæ˜¯ï¼šã€ç”¨Runnableï¼Œçº¿ç¨‹è¢«åˆ›å»ºâ€¦.ã€‘</p>
<p>Thread.start()æ–¹æ³•çš„æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.threadStatus != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalThreadStateException</span>();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-built_in">this</span>.group.add(<span class="hljs-built_in">this</span>);<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">started</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-built_in">this</span>.start0();<br>                started = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">if</span> (!started) &#123;<br>                        <span class="hljs-built_in">this</span>.group.threadStartFailed(<span class="hljs-built_in">this</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (Throwable var8) &#123;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><code>this.start0();</code>å¯ä»¥çœ‹å‡ºæ¥æ˜¯è¿™å¥è¯çœŸæ­£åˆ›å»ºäº†çº¿ç¨‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start0</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure>

<p>å¯æ˜¯æ·±å…¥è¿›å»è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œæ˜¯ç”±c&#x2F;c++ç¼–å†™çš„ï¼Œä¾›JVMè°ƒç”¨ã€‚æ‰€ä»¥<code>Thread.start()</code>å°†çº¿ç¨‹å¯åŠ¨åï¼Œåœ¨åº•å±‚ä»£ç ä¸­ï¼ŒJVMå°†ä¼šè‡ªåŠ¨å›è°ƒ<code>Thread.run()</code>æ–¹æ³•ã€‚ç”±äºå®ç°Runnableæ¥å£åï¼Œå°†å®ç°ç±»çš„å®ä¾‹ä¼ åˆ°Threadçš„æ„é€ å™¨ä¸­ï¼Œ<code>Runnable target;</code>  è¿™ä¸ªtargetå°±æ˜¯è¿™ä¸ªå®ä¾‹ï¼Œå› æ­¤åœ¨Thread.run() ä¸­å®é™…ä¸Šåˆè°ƒç”¨äº†æˆ‘ä»¬é‡å†™çš„run()æ–¹æ³•ï¼Œå› æ­¤ä¼šæœ‰è¿™æ ·çš„è¾“å‡ºç»“æœã€‚</p>
<p><em>Thread.run() æºç ï¼š</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.target != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-built_in">this</span>.target.run();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-2-ç»§æ‰¿Threadç±»"><a href="#2-2-ç»§æ‰¿Threadç±»" class="headerlink" title="2.2 ç»§æ‰¿Threadç±»"></a>2.2 ç»§æ‰¿Threadç±»</h2><p>ç›´æ¥ç»§æ‰¿Threadç±»æ¥é‡å†™run()æ–¹æ³•ï¼Œæœ€ç»ˆè¿™ä¸ªé‡å†™çš„run()æ–¹æ³•ä½“çš„å†…å®¹å°†ä¼šç›´æ¥è¦†ç›–çˆ¶ç±»run()æ–¹æ³•ä¸­çš„ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadStyle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç»§æ‰¿threadç±»ï¼Œçº¿ç¨‹è¢«åˆ›å»º...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">threadStyle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadStyle</span>();<br>        threadStyle.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h2><p>å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹æ˜¯<strong>ä¼˜äº</strong>ç»§æ‰¿Threadåˆ›å»ºçº¿ç¨‹ã€‚</p>
<ul>
<li>javaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œå¦‚æœå·²ç»ç»§æ‰¿äº†Threadç±»çš„è¯ï¼Œå°±ä¸èƒ½å†ç»§æ‰¿å…¶ä»–ç±»äº†ï¼Œå¤§å¤§é™åˆ¶äº†å¯æ‰©å±•æ€§ã€‚</li>
<li><em>å®ç°Runnableæ¥å£æ¯”è¾ƒèŠ‚çº¦èµ„æºã€‚â€”â€”æœ‰å¾…è€ƒè¯ï¼Œä¸å¤ªç†è§£</em></li>
<li>ä»ä»£ç æ¶æ„çš„è§’åº¦ï¼Œä½¿ç”¨æ¥å£æœ‰åˆ©äºé™ä½ç¨‹åºé—´çš„è€¦åˆåº¦ï¼Œçº¿ç¨‹å…·ä½“è¦æ‰§è¡Œçš„ä»»åŠ¡ä¸çº¿ç¨‹çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ä»£ç åº”è¯¥è§£è€¦ï¼Œå› ä¸ºçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ–¹æ³•æ˜¯start()ã€çº¿ç¨‹é˜»å¡ï¼Œçº¿ç¨‹ç»ˆæ­¢ç­‰ï¼Œè¿™æ˜¯ç”±Threadç±»æ‰€ç®¡ç†çš„ï¼Œä»–ä»¬ç›®çš„ä¸ä¸€æ ·ï¼Œæ‰€ä»¥åº”è¯¥è§£è€¦ã€‚</li>
</ul>
<h2 id="2-3-åˆ›å»ºçº¿ç¨‹çš„é”™è¯¯è§‚ç‚¹"><a href="#2-3-åˆ›å»ºçº¿ç¨‹çš„é”™è¯¯è§‚ç‚¹" class="headerlink" title="2.3 åˆ›å»ºçº¿ç¨‹çš„é”™è¯¯è§‚ç‚¹"></a>2.3 åˆ›å»ºçº¿ç¨‹çš„é”™è¯¯è§‚ç‚¹</h2><p>ä»¥ä¸‹è¿™äº›ï¼Œä»…ä»…æ˜¯åœ¨ä»£ç å±‚é¢çš„åƒå˜ä¸‡åŒ–ï¼Œä½†å…¶æœ¬è´¨æ˜¯ä¸‡å˜ä¸ç¦»å…¶å®—çš„ã€‚</p>
<p><strong>1.çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹</strong></p>
<p>æœ¬è´¨æ˜¯</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-built_in">this</span>.group, r, <span class="hljs-built_in">this</span>.namePrefix + <span class="hljs-built_in">this</span>.threadNumber.getAndIncrement(), <span class="hljs-number">0L</span>);<br></code></pre></td></tr></table></figure>

<p><strong>2.é€šè¿‡Callableå’ŒFutureTaskåˆ›å»ºçº¿ç¨‹</strong></p>
<p><img src="/image/juc/1.png" srcset="/image/beautify/loading.gif" lazyload></p>
<p><img src="/image/juc/2.png" srcset="/image/beautify/loading.gif" lazyload></p>
<p><strong>3.å®šæ—¶å™¨åˆ›å»ºçº¿ç¨‹</strong></p>
<p>æœ¬è´¨æ˜¯Thread thread &#x3D; new Thread(â€¦..)</p>
<p><strong>4.åŒ¿åç±»éƒ¨ç±»ï¼Œlambdaè¡¨è¾¾å¼</strong></p>
<h2 id="2-4-æœ‰å¤šå°‘ç§å®ç°çº¿ç¨‹çš„æ–¹æ³•"><a href="#2-4-æœ‰å¤šå°‘ç§å®ç°çº¿ç¨‹çš„æ–¹æ³•" class="headerlink" title="2.4 æœ‰å¤šå°‘ç§å®ç°çº¿ç¨‹çš„æ–¹æ³•"></a>2.4 æœ‰å¤šå°‘ç§å®ç°çº¿ç¨‹çš„æ–¹æ³•</h2><p>ä»ä¸åŒçš„è§’åº¦çœ‹ï¼Œä¼šæœ‰ä¸åŒçš„ç­”æ¡ˆã€‚</p>
<p>1.ä¸¤ç§æœ¬è´¨å®ç°æ–¹æ³•</p>
<p>å®ç°Runnableæ¥å£å’Œç»§æ‰¿Threadç±»ï¼Œæ¯”è¾ƒä»–ä»¬çš„ä¼˜ç¼ºç‚¹ï¼Œé€šè¿‡çœ‹æºä»£ç ï¼Œå‘ç°å…¶å®ä»–ä»¬çš„æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡Threadçš„æ„é€ æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹</p>
<p>2.å‡ ç§ä»£ç å®ç°æ–¹æ³•</p>
<p>å…¶ä»–çš„å¤–åœ¨è¡¨ç°å½¢å¼çš„æœ¬è´¨è¿˜æ˜¯é€šè¿‡threadç±»åˆ›å»ºçº¿ç¨‹</p>
<h1 id="3-å¯åŠ¨çº¿ç¨‹"><a href="#3-å¯åŠ¨çº¿ç¨‹" class="headerlink" title="3.å¯åŠ¨çº¿ç¨‹"></a>3.å¯åŠ¨çº¿ç¨‹</h1><p>åªæœ‰start()æ–¹æ³•æ˜¯å¯åŠ¨çº¿ç¨‹çš„æ–¹æ³•ï¼Œ<strong>ä¼šç»å†çº¿ç¨‹çš„å„ä¸ªç”Ÿå‘½å‘¨æœŸ</strong>ã€‚</p>
<p>åœ¨å½“å‰çº¿ç¨‹ï¼ˆä¸€èˆ¬æ˜¯ä¸»çº¿ç¨‹ï¼‰ä¸­åˆ›å»ºæ–°çº¿ç¨‹å¯¹è±¡ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œstart()æ–¹æ³•ï¼Œstart()æ–¹æ³•å†…çš„æœ¬åœ°æ–¹æ³•start0()ä¼šé€šçŸ¥JVMåœ¨æœ‰ç©ºé—²çš„æƒ…å†µä¸‹å»è¿è¡Œè¿™ä¸ªçº¿ç¨‹ï¼Œä¸è¿‡è‡³äºè¿™ä¸ªçº¿ç¨‹ä½•æ—¶å»è¿è¡Œï¼Œç”±çº¿ç¨‹è°ƒåº¦å™¨å†³å®šï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹å¯èƒ½ç¨åæˆ–è€…å¾ˆä¹…éƒ½ä¸è¿è¡Œã€‚</p>
<p>ä¸èƒ½é‡å¤æ‰§è¡Œstart()æ–¹æ³•ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡è°ƒç”¨è¿‡åï¼Œçº¿ç¨‹çŠ¶æ€ä¼šè¢«æ”¹å˜ï¼Œåœ¨ç¬¬äºŒæ¬¡å†æ‰§è¡Œstart()åï¼Œçº¿ç¨‹çŠ¶æ€å°±ä¸æ˜¯åˆå§‹çš„åˆ›å»ºçš„çŠ¶æ€äº†ã€‚</p>
<p>å¦‚æœç›´æ¥è°ƒç”¨run()æ–¹æ³•çš„è¯ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ï¼Œæœ€ç»ˆçš„çº¿ç¨‹è¿˜æ˜¯ä¸»çº¿ç¨‹ï¼Œå¹¶æ²¡æœ‰åšé€šçŸ¥è™šæ‹Ÿæœºç­‰ç›¸å…³æ“ä½œï¼Œå¹¶ä¸èƒ½æ‰§è¡Œæ–°çº¿ç¨‹ã€‚æ‰€ä»¥å¿…é¡»ç”±è™šæ‹Ÿæœºå›è°ƒè¿™ä¸ªæ–¹æ³•æ‰å¯ä»¥</p>
<h1 id="4-åœæ­¢çº¿ç¨‹"><a href="#4-åœæ­¢çº¿ç¨‹" class="headerlink" title="4.åœæ­¢çº¿ç¨‹"></a>4.åœæ­¢çº¿ç¨‹</h1><p>å¦‚æœ<strong>æ²¡æœ‰å¤–ç•Œå¹²æ¶‰</strong>çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹é€šå¸¸çš„åœæ­¢è¿‡ç¨‹ï¼š</p>
<ol>
<li>run()æ–¹æ³•æ‰§è¡Œå®Œæ¯•</li>
<li>æœ‰ä¸€ç‚¹å¼‚å¸¸å‡ºç°ï¼Œä½†æ²¡æœ‰è¢«æ•è·</li>
</ol>
<p>åœ¨æœ‰å¤–ç•Œå¹²æ¶‰çš„æƒ…å†µä¸‹ï¼Œæ­£ç¡®åœæ­¢çº¿ç¨‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code>interrupt</code>ï¼Œå¥½å¤„ï¼šæ•°æ®å®‰å…¨ï¼Œå¹¶ä¸”æˆ‘ä»¬è¦æŠŠä¸»åŠ¨æƒäº¤ç»™è¢«ä¸­æ–­çº¿ç¨‹ã€‚</p>
<p><strong>åŸç†ï¼š</strong>ä½¿ç”¨interruptæ¥<strong>é€šçŸ¥</strong>ï¼Œè€Œä¸æ˜¯<strong>å¼ºåˆ¶</strong>ã€‚</p>
<h3 id="4-1åœæ­¢çº¿ç¨‹çš„å‡ ç§æƒ…å†µ"><a href="#4-1åœæ­¢çº¿ç¨‹çš„å‡ ç§æƒ…å†µ" class="headerlink" title="4.1åœæ­¢çº¿ç¨‹çš„å‡ ç§æƒ…å†µ"></a>4.1åœæ­¢çº¿ç¨‹çš„å‡ ç§æƒ…å†µ</h3><ol>
<li>å½“çº¿ç¨‹å¤„äºæ­£åœ¨è¿è¡Œæ—¶ï¼ˆä¸å¤„äºé˜»å¡çŠ¶æ€ï¼‰ï¼Œä½¿ç”¨interruptåœæ­¢çº¿ç¨‹ï¼Œå¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RigthWayToStopThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++)&#123;<br>            <span class="hljs-comment">//å½“å‰çº¿ç¨‹æ˜¯å¦å“åº”ä¸­æ–­å–å†³äºçº¿ç¨‹å†…çš„ä»£ç é€»è¾‘æ˜¯å¦å“åº”è¿™ä¸ªä¸­æ–­ï¼Œå¦‚æœä¸å“åº”å°±å¯ä»¥ç»§ç»­è¿è¡Œã€‚</span><br>            <span class="hljs-comment">//æœ¬ä¾‹ä¸­ï¼Œå½“æ¥æ”¶åˆ°ä¸­æ–­ä¿¡å·æ—¶ï¼Œå°±ä¼šå“åº”ä¸­æ–­ï¼Œè¿™æ˜¯äººä¸ºç¼–å†™çš„</span><br>            <span class="hljs-keyword">if</span>(Thread.currentThread().interrupted())&#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(i % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>)&#123;<br>                System.out.println(i + <span class="hljs-string">&quot; &quot;</span>+Thread.currentThread().getName());<br>            &#125;<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹åœæ­¢äº†&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">RigthWayToStopThread</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RigthWayToStopThread</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r);<br>        thread.start();<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        thread.interrupt();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°å½“è¿™ä¸ªçº¿ç¨‹å¯ä»¥å“åº”åˆ°åœæ­¢ä¿¡å·ï¼Œå°±ä¼šåœæ­¢è¿è¡Œã€‚</p>
<ol start="2">
<li>å½“çº¿ç¨‹å¤„äºé˜»å¡æ—¶ï¼Œä½¿ç”¨interruptåœæ­¢çº¿ç¨‹ï¼š</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RigthWayToStopThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++)&#123;<br>            <span class="hljs-keyword">if</span>(Thread.currentThread().interrupted())&#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(i % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>)&#123;<br>                System.out.println(i + <span class="hljs-string">&quot; &quot;</span>+Thread.currentThread().getName());<br>            &#125;<br>        &#125;<br>            System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹åœæ­¢&quot;</span>);<br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">RigthWayToStopThread</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RigthWayToStopThread</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r);<br>        thread.start();<br>        Thread.sleep(<span class="hljs-number">50</span>);<br>        <span class="hljs-comment">// Thread.sleep(500);</span><br>        thread.interrupt();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç¨‹åºæ‰§è¡Œç»“æœï¼š</p>
<p>è¿™ç§æƒ…å†µå°±å’Œç¬¬ä¸€ç‚¹çš„ä¸€æ ·äº†ï¼Œçº¿ç¨‹æ­£åœ¨è¿è¡Œçš„æ—¶å€™è¢«åœæ­¢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ‰“å°içš„å€¼å’Œçº¿ç¨‹åç§°...çœç•¥</span><br>çº¿ç¨‹åœæ­¢<br><br>Process finished with exit code <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§æƒ…å†µæ˜¯ç”±äºä½¿ç”¨sleepè¯­å¥æ—¶éœ€è¦try catchå°†è¿™ä¸ªå¼‚å¸¸æ•æ‰ï¼Œæ‰€ä»¥å½“ä½¿ç”¨Interruptåœæ­¢çº¿ç¨‹æ—¶ï¼Œæ­¤æ—¶æ­£å¤„äºsleepé˜»å¡çŠ¶æ€ï¼Œè¿™ä¸ªinterruptä¿¡å·ä¼šè¢«catchä½</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ‰“å°içš„å€¼å’Œçº¿ç¨‹åç§°...çœç•¥</span><br>java.lang.InterruptedException: sleep interrupted<br>	at java.base/java.lang.Thread.sleep(Native Method)<br>	at juc.thread.RigthWayToStopThread.run(RigthWayToStopThread.java:<span class="hljs-number">20</span>)<br>	at java.base/java.lang.Thread.run(Thread.java:<span class="hljs-number">834</span>)<br><br>Process finished with exit code <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li>æ¯æ¬¡è¿­ä»£çš„è¿‡ç¨‹éƒ½é˜»å¡</li>
</ol>
<p>æŠŠsleepè¯­å¥æ”¾åˆ°forå¾ªç¯å†…ï¼Œï¼ˆé˜»å¡æ—¶é—´å¤§äºæ¯æ¬¡çš„è¿è¡Œæ—¶é—´ï¼‰æ¯æ¬¡é˜»å¡çš„æ—¶å€™ï¼Œå¦‚æœæœ‰interruptä¿¡å·ï¼Œéƒ½ä¼šè¢«catchæ•æ‰åˆ°å¼‚å¸¸ã€‚ä¹Ÿä¸éœ€è¦  **if(Thread.currentThread().interrupted()){    break;  } **è¯­å¥äº†</p>
<p>sleepçš„try catch ä¸€æ—¦å“åº”ä¸­æ–­ï¼Œä¾¿ä¼šæŠŠä¸­æ–­æ ‡å¿—ä½æ¸…é™¤ï¼Œå›åˆ°æ²¡æœ‰è¢«ä¸­æ–­çš„çŠ¶æ€ã€‚</p>
<h3 id="4-2-å¤„ç†ä¸­æ–­çš„æ–¹æ³•"><a href="#4-2-å¤„ç†ä¸­æ–­çš„æ–¹æ³•" class="headerlink" title="4.2 å¤„ç†ä¸­æ–­çš„æ–¹æ³•"></a>4.2 å¤„ç†ä¸­æ–­çš„æ–¹æ³•</h3><ol>
<li><p>ä¼˜å…ˆé€‰æ‹©ï¼š<strong>ä¼ é€’ä¸­æ–­</strong>ã€‚catchäº†InterruptedExcetionä¹‹åï¼Œåœ¨æ–¹æ³•ç­¾åä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨åº•å±‚æ–¹æ³•ä¸­ä¸èƒ½æŠŠå¼‚å¸¸åäº†ï¼ï¼</p>
<p>å½“run()æ–¹æ³•è°ƒç”¨äº†ä¸€ä¸ªæ–¹æ³•a()ï¼Œè€Œaä¸­æœ‰try catchç›¸å…³çš„å†…å®¹æ•è·åœæ­¢ä¿¡å·ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¦åœæ­¢run()å¯¹åº”çš„çº¿ç¨‹ï¼Œa()æ–¹æ³•æ„ŸçŸ¥åˆ°äº†interruptä¿¡å·ï¼Œä¼šæ•è·å¼‚å¸¸ï¼Œä½†æ˜¯ä¼šæŠŠinterruptæ ‡å¿—ä½æ¸…é™¤ï¼Œæ‰€ä»¥run()æ–¹æ³•è¿˜æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œaæ–¹æ³•çš„catchæ‰“å°äº†ä¸­æ–­ä¿¡æ¯ä¹Ÿä¸ä¼šè¢«å‘ç°ã€‚</p>
<p>æ­£ç¡®çš„æ–¹æ³•æ˜¯aæ–¹æ³•åœ¨æ–¹æ³•ç­¾åä¸­æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œè®©runå¤„ç†è¿™ä¸ªå¼‚å¸¸ï¼Œå¯ä»¥æ˜¯ä¿å­˜æ—¥å¿—ç­‰ç­‰â€¦.</p>
</li>
<li><p>æ— æ³•æˆ–ä¸æƒ³ä¼ é€’ä¸­æ–­ï¼š<strong>æ¢å¤ä¸­æ–­</strong></p>
<p>åœ¨catchå­å¥ä¸­è°ƒç”¨Thread.currentThread().interrupt()æ¥æ¢å¤è®¾ç½®ä¸­æ–­çŠ¶æ€ï¼Œä»¥ä¾¿åœ¨ååºçš„æ‰§è¡Œä¸­ï¼Œä¾ç„¶èƒ½å¤Ÿæ£€æŸ¥åˆ°åˆšæ‰çš„ä¸­æ–­ã€‚</p>
</li>
<li><p>ä¸åº”å±è”½ä¸­æ–­</p>
</li>
</ol>
<h3 id="4-3-å“ªäº›æ–¹æ³•å¯ä»¥å“åº”ä¸­æ–­"><a href="#4-3-å“ªäº›æ–¹æ³•å¯ä»¥å“åº”ä¸­æ–­" class="headerlink" title="4.3 å“ªäº›æ–¹æ³•å¯ä»¥å“åº”ä¸­æ–­"></a>4.3 å“ªäº›æ–¹æ³•å¯ä»¥å“åº”ä¸­æ–­</h3><p>å“åº”ä¸­æ–­æŒ‡å½“ä¸­æ–­ä¿¡å·å‘å‡ºæ—¶ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥æ„ŸçŸ¥åˆ°è¿™ä¸ªä¸­æ–­ï¼Œå¹¶æ•è·ã€‚</p>
<p>wait()  sleep()  join() ç­‰ç­‰</p>
<h3 id="4-4-é”™è¯¯çš„åœæ­¢æ–¹æ³•"><a href="#4-4-é”™è¯¯çš„åœæ­¢æ–¹æ³•" class="headerlink" title="4.4 é”™è¯¯çš„åœæ­¢æ–¹æ³•"></a>4.4 é”™è¯¯çš„åœæ­¢æ–¹æ³•</h3><ol>
<li><p>stopï¼Œsuspendï¼Œresumeæ–¹æ³•</p>
<p>**stop()**æ¥åœæ­¢çº¿ç¨‹ä¼šå¯¼è‡´çº¿ç¨‹è¿è¡Œä¸€åŠçªç„¶åœæ­¢ï¼Œæ²¡åŠæ³•å®Œæˆä¸€ä¸ªåŸºæœ¬å•ä½çš„æ“ä½œï¼Œä¼šé€ æˆè„æ•°æ®ã€‚ stopæ˜¯ä¸å®‰å…¨çš„ã€‚</p>
</li>
<li><p>volatileè®¾ç½®booleanæ ‡è®°ä½</p>
<p>æ— æ³•å¤„ç†é•¿æ—¶é—´é˜»å¡çš„æƒ…å†µ</p>
</li>
</ol>
<h1 id="5-çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#5-çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="5.çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"></a>5.çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h1><p><img src="/image/juc/3.png" srcset="/image/beautify/loading.gif" lazyload></p>
<p>è¡¥å……ï¼šå½“çº¿ç¨‹åˆšåˆšè¢«å”¤é†’æ—¶ï¼Œç”±äºå”¤é†’å®ƒçš„çº¿ç¨‹æŒæœ‰è¿™ä¸ªé”ï¼Œå› æ­¤çº¿ç¨‹ä¸èƒ½ç«‹åˆ»è·å¾—åˆ°é”ï¼Œå› æ­¤ä¼šè¿›å…¥BLOCKEDé˜¶æ®µï¼Œå¦‚æœåœ¨waité˜¶æ®µè¢«ä¸­æ–­ï¼Œä¼šç›´æ¥è¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚</p>
<h2 id="5-1-NEW"><a href="#5-1-NEW" class="headerlink" title="5.1 NEW"></a>5.1 NEW</h2><p>åˆå§‹çŠ¶æ€ï¼Œçº¿ç¨‹è¢«æ„å»ºï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è°ƒç”¨start()æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSixStatus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) &#123;<br>            System.out.println(i+<span class="hljs-string">&quot; &quot;</span>+Thread.currentThread().getName());<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadSixStatus</span> <span class="hljs-variable">threadSixStatus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadSixStatus</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        System.out.println(thread.getState());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç¨‹åºçš„è¾“å‡ºç»“æœæ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">NEW<br></code></pre></td></tr></table></figure>

<p>å¯è§åˆšåˆšåˆ›å»ºçš„çº¿ç¨‹çš„çŠ¶æ€æ˜¯NEWï¼Œæ²¡æœ‰start()å¯åŠ¨çº¿ç¨‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿è¡ŒRunnableæ¥å£å®ç°ç±»çš„run()æ–¹æ³•ã€‚</p>
<h2 id="5-2-RUNNABLE-å¯è¿è¡Œçš„-è¿è¡Œä¸­çš„"><a href="#5-2-RUNNABLE-å¯è¿è¡Œçš„-è¿è¡Œä¸­çš„" class="headerlink" title="5.2 RUNNABLE(å¯è¿è¡Œçš„&#x2F;è¿è¡Œä¸­çš„)"></a>5.2 RUNNABLE(å¯è¿è¡Œçš„&#x2F;è¿è¡Œä¸­çš„)</h2><p>è¿è¡ŒçŠ¶æ€ï¼Œjavaçº¿ç¨‹å°†æ“ä½œç³»ç»Ÿä¸­çš„<strong>å°±ç»ª</strong>å’Œ<strong>è¿è¡Œ</strong>ä¸¤ç§çŠ¶æ€ç¬¼ç»Ÿçš„ç§°ä¸ºâ€œè¿è¡Œä¸­â€ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSixStatus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) &#123;<br>            System.out.println(i+<span class="hljs-string">&quot; &quot;</span>+Thread.currentThread().getName());<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadSixStatus</span> <span class="hljs-variable">threadSixStatus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadSixStatus</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        System.out.println(thread.getState());<br>        thread.start();<br>        System.out.println(thread.getState());<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">50</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(thread.getState());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">NEW<br>RUNNABLE<br><span class="hljs-number">0</span> Thread-<span class="hljs-number">0</span><br><span class="hljs-number">1</span> Thread-<span class="hljs-number">0</span><br><span class="hljs-number">2</span> Thread-<span class="hljs-number">0</span><br>  ......<br><span class="hljs-number">707</span> Thread-<span class="hljs-number">0</span><br>RUNNABLE<br>  ......<br><span class="hljs-number">999</span> Thread-<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>thread.start();ä¹‹åï¼Œçº¿ç¨‹å°±å¤„äºRUNNABLEçŠ¶æ€ï¼Œè¿™æ—¶å¦‚æœè¢«åˆ†åˆ°äº†CPUï¼Œå°±è¿è¡Œï¼Œæ²¡æœ‰è¢«åˆ†åˆ°CPUï¼Œå°±å¤„äºå°±ç»ªçŠ¶æ€ï¼Œç­‰ä¼šï¼Œå½“å¼€å§‹è¿è¡Œæ—¶ï¼Œjvmä¼šè°ƒç”¨run()æ–¹æ³•ï¼Œè¾“å‡ºä¸Šé¢çš„å†…å®¹ã€‚</p>
<h2 id="5-3-BLOCKED"><a href="#5-3-BLOCKED" class="headerlink" title="5.3 BLOCKED"></a>5.3 BLOCKED</h2><p>é˜»å¡çŠ¶æ€ï¼Œè¡¨ç¤ºçº¿ç¨‹é˜»å¡äºé”ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSixStatus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        syn();<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadSixStatus</span> <span class="hljs-variable">threadSixStatus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadSixStatus</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        thread1.start();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        thread2.start();<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;thread1çš„çŠ¶æ€ï¼š&quot;</span>+thread1.getState());<br>        System.out.println(<span class="hljs-string">&quot;thread2çš„çŠ¶æ€ï¼š&quot;</span>+thread2.getState());<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">syn</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºçš„ç»“æœä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">thread1çš„çŠ¶æ€ï¼šTIMED_WAITING<br>thread2çš„çŠ¶æ€ï¼šBLOCKED<br></code></pre></td></tr></table></figure>

<p>è¿™æ˜¯ç”±äºçº¿ç¨‹1å…ˆè¢«å¯åŠ¨ï¼Œç„¶åè¿›å…¥syn()æ–¹æ³•ä¸­ï¼Œå°±ä¼šå¤„äºç¡çœ 10sçš„çŠ¶æ€ï¼Œç”±äºmainå‡½æ•°ä¸­è·å–çº¿ç¨‹1çŠ¶æ€å‰ç¡çœ 10msï¼Œæ‰€ä»¥å½“è·å–çº¿ç¨‹1çš„çŠ¶æ€æ—¶ï¼Œçº¿ç¨‹1ä¸€å®šå¤„äºç¡çœ ï¼Œæ‰€ä»¥æ˜¯TIMED_WAITINGï¼Œè€Œæ­¤æ—¶çº¿ç¨‹1æ‹¿ç€syn()æ–¹æ³•çš„é”ï¼Œçº¿ç¨‹2æ— æ³•è¿è¡Œsyn()æ–¹æ³•ï¼Œåªèƒ½é˜»å¡è‡ªèº«ç­‰å¾…é”ï¼Œæ‰€ä»¥æ˜¯BLOCKED</p>
<h2 id="5-4-WAITING"><a href="#5-4-WAITING" class="headerlink" title="5.4 WAITING"></a>5.4 WAITING</h2><p>ç­‰å¾…çŠ¶æ€ï¼Œè¡¨ç¤ºçº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œè¿›å…¥è¯¥çŠ¶æ€è¡¨ç¤ºå½“å‰çº¿ç¨‹éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹åšå‡ºä¸€äº›ç‰¹æ€§åŠ¨ä½œï¼Œå¦‚é€šçŸ¥æˆ–ä¸­æ–­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> juc.thread;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Author</span> qq</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Date</span> 2022/3/12</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSixStatus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        syn();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadSixStatus</span> <span class="hljs-variable">threadSixStatus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadSixStatus</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        thread1.start();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        thread2.start();<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">10</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;thread1çš„çŠ¶æ€ï¼š&quot;</span>+thread1.getState());<br>        System.out.println(<span class="hljs-string">&quot;thread2çš„çŠ¶æ€ï¼š&quot;</span>+thread2.getState());<br>        System.out.println(<span class="hljs-string">&quot;-------------&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">1100</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;thread1çš„çŠ¶æ€ï¼š&quot;</span>+thread1.getState());<br>        System.out.println(<span class="hljs-string">&quot;thread2çš„çŠ¶æ€ï¼š&quot;</span>+thread2.getState());<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">syn</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>            System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹è¿›å…¥åˆ°waitç­‰å¾…&quot;</span>);<br>            wait();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">thread1çš„çŠ¶æ€ï¼šTIMED_WAITING<br>thread2çš„çŠ¶æ€ï¼šBLOCKED<br>-------------<br>çº¿ç¨‹è¿›å…¥åˆ°waitç­‰å¾…<br>thread1çš„çŠ¶æ€ï¼šWAITING<br>thread2çš„çŠ¶æ€ï¼šTIMED_WAITING<br>çº¿ç¨‹è¿›å…¥åˆ°waitç­‰å¾…<br></code></pre></td></tr></table></figure>

<p>è¿™è¯´æ˜çº¿ç¨‹1å…ˆè¿›å…¥WAITINGçŠ¶æ€ï¼Œç„¶åä¼šé‡Šæ”¾è¿™ä¸ªé”ï¼Œçº¿ç¨‹2æ‹¿åˆ°é”åè¿›å…¥sleepï¼Œä¼‘çœ æ—¶é—´è¿‡äº†ä¹‹åä¹Ÿä¼šè¿›å…¥WAITINGçŠ¶æ€ï¼Œæ­¤æ—¶æ§åˆ¶å°æ˜¾ç¤ºç¨‹åºå¹¶æ²¡æœ‰åœæ­¢è¿è¡Œï¼Œæ³¨æ„æ¡†ä½çš„éƒ¨åˆ†ã€‚</p>
<p><img src="/image/juc/4.png" srcset="/image/beautify/loading.gif" lazyload></p>
<h2 id="5-5-TIMED-WAITING"><a href="#5-5-TIMED-WAITING" class="headerlink" title="5.5 TIMED_WAITING"></a>5.5 TIMED_WAITING</h2><p>è¶…æ—¶ &#x2F; è®¡æ—¶ç­‰å¾…çŠ¶æ€ï¼Œè¯¥çŠ¶æ€ä¸åŒäºWAITING,å®ƒæ˜¯å¯ä»¥åœ¨æŒ‡å®šæ—¶é—´è‡ªè¡Œè¿”å›çš„ã€‚</p>
<p>çœ‹BLOCKEDä¸­çš„ä»£ç ã€‚</p>
<h2 id="5-6-TERMINATED"><a href="#5-6-TERMINATED" class="headerlink" title="5.6 TERMINATED"></a>5.6 TERMINATED</h2><p>ç»ˆæ­¢çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚çº¿ç¨‹çš„run()æ–¹æ³•ã€call()æ–¹æ³•æ­£å¸¸æ‰§è¡Œå®Œæ¯•æˆ–è€…çº¿ç¨‹æŠ›å‡ºä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸(Exception)ã€é”™è¯¯(Error)ï¼Œçº¿ç¨‹å°±è¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚ä¸€æ—¦è¿›å…¥ç»ˆæ­¢çŠ¶æ€ï¼Œçº¿ç¨‹å°†ä¸å†æ‹¥æœ‰è¿è¡Œçš„èµ„æ ¼ï¼Œä¹Ÿä¸èƒ½å†è½¬æ¢åˆ°å…¶ä»–çŠ¶æ€ï¼Œç”Ÿå‘½å‘¨æœŸç»“æŸã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSixStatus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) &#123;<br>            System.out.println(i+<span class="hljs-string">&quot; &quot;</span>+Thread.currentThread().getName());<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadSixStatus</span> <span class="hljs-variable">threadSixStatus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadSixStatus</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadSixStatus);<br>        System.out.println(thread.getState());<br>        thread.start();<br>        System.out.println(thread.getState());<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">1000</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(thread.getState());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>1sé’Ÿç¨‹åºä¸€å®šæ‰§è¡Œå®Œæ¯•äº†ï¼Œæ‰€ä»¥æ‰“å°çº¿ç¨‹çŠ¶æ€æ˜¯TERMINATED</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">  ......<br><span class="hljs-number">999</span> Thread-<span class="hljs-number">0</span><br>TERMINATED<br></code></pre></td></tr></table></figure>

<p>é˜»å¡çŠ¶æ€ï¼šä¸€èˆ¬æŠŠBlocked(è¢«é˜»å¡)ã€Waiting(ç­‰å¾…)ã€Timed_waiting(è®¡æ—¶ç­‰å¾…)éƒ½ç§°ä¸ºé˜»å¡çŠ¶æ€ã€‚</p>
<h1 id="6-Threadç±»çš„é‡è¦æ–¹æ³•è¯¦è§£"><a href="#6-Threadç±»çš„é‡è¦æ–¹æ³•è¯¦è§£" class="headerlink" title="6.Threadç±»çš„é‡è¦æ–¹æ³•è¯¦è§£"></a>6.Threadç±»çš„é‡è¦æ–¹æ³•è¯¦è§£</h1><h2 id="6-1-sleep"><a href="#6-1-sleep" class="headerlink" title="6.1 sleep()"></a>6.1 sleep()</h2><p>çº¿ç¨‹sleepçš„æ—¶å€™ä¸é‡Šæ”¾lockä»¥åŠsynchronizedçš„monitoré”ï¼Œç­‰sleepæ—¶é—´åˆ°äº†ä»¥åï¼Œçº¿ç¨‹æ­£å¸¸ç»“æŸåæ‰é‡Šæ”¾é”ã€‚</p>
<p>sleepæ–¹æ³•å¯ä»¥è®©çº¿ç¨‹è¿›å…¥WaitingçŠ¶æ€ï¼Œå¹¶ä¸”ä¸å ç”¨CPUèµ„æºï¼Œä½†æ˜¯ä¸é‡Šæ”¾é”ï¼Œç›´åˆ°è§„å®šæ—¶é—´å†æ‰§è¡Œï¼Œä¼‘çœ æœŸé—´å¦‚æœè¢«ä¸­æ–­ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸å¹¶æ¸…é™¤ä¸­æ–­çŠ¶æ€ã€‚</p>
<p><code>TimeUnit.SECONDS.sleep(1);</code>æ¯”<code>Thread.sleep()</code>æ›´ä¼˜é›…</p>
<p>sleep()ä¸éœ€è¦æ”¾åœ¨åŒæ­¥ä»£ç å—ä¸­ã€‚</p>
<h2 id="6-2-join"><a href="#6-2-join" class="headerlink" title="6.2.join()"></a>6.2.join()</h2><p>å½“æœ‰æ–°çš„å­çº¿ç¨‹åŠ å…¥æ—¶ï¼Œå­çº¿ç¨‹è°ƒç”¨jion()ï¼Œä¸»çº¿ç¨‹ä¼šç­‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åå†å¾€ä¸‹è¿è¡Œï¼Œå¦‚æœå­çº¿ç¨‹ä¸è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå½“å®ƒè¿˜æ²¡æ‰§è¡Œå®Œçš„æ—¶å€™ï¼Œä¸»çº¿ç¨‹å°±ä¼šç»§ç»­æ‰§è¡Œã€‚</p>
<p><strong>å½“join()çš„æ—¶å€™ä¸»çº¿ç¨‹çš„çŠ¶æ€æ˜¯WAIT</strong>ï¼Œä¸€ä¸ªçº¿ç¨‹å»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹</p>
<p>ä¸‹é¢çš„ä»£ç å°±è¯´æ˜äº†ä¸»çº¿ç¨‹ä¸ä¸€å®šä¼šç­‰å­çº¿ç¨‹æ‰§è¡Œå®Œå†æ‰§è¡Œï¼Œå› ä¸ºstart()æ–¹æ³•å¯åŠ¨çº¿ç¨‹ï¼Œçº¿ç¨‹ä¸ä¸€å®šç«‹åˆ»å°±è·å¾—åˆ°CPUèµ„æºã€‚å¦‚æœåœ¨å­çº¿ç¨‹ä¸­sleppï¼Œé‚£ä¸»çº¿ç¨‹åº”è¯¥æ˜¯ç¬¬ä¸€ä¸ªæ‰§è¡Œå®Œï¼Œç„¶åæ‰æ˜¯å­çº¿ç¨‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">join</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                System.out.println(Thread.currentThread().getName()+<span class="hljs-string">&quot;å¼€å§‹æ‰§è¡Œ&quot;</span>);<br>            &#125;<br>        &#125;).start();<br><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                System.out.println(Thread.currentThread().getName()+<span class="hljs-string">&quot;å¼€å§‹æ‰§è¡Œ&quot;</span>);<br>            &#125;<br>        &#125;).start();<br>        System.out.println(Thread.currentThread().getName()+<span class="hljs-string">&quot;æ‰§è¡Œ&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š<strong>ï¼ˆè¿™ä¸ªé¡ºåºå…·æœ‰éšæœºæ€§ï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Thread-<span class="hljs-number">0</span>å¼€å§‹æ‰§è¡Œ<br>mainæ‰§è¡Œ<br>Thread-<span class="hljs-number">1</span>å¼€å§‹æ‰§è¡Œ<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å¦‚æœåŠ å…¥äº†join()</span><br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">join</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    TimeUnit.SECONDS.sleep(<span class="hljs-number">2</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>                System.out.println(Thread.currentThread().getName()+<span class="hljs-string">&quot;å¼€å§‹æ‰§è¡Œ&quot;</span>);<br>            &#125;<br>        &#125;);<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    TimeUnit.SECONDS.sleep(<span class="hljs-number">1</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>                System.out.println(Thread.currentThread().getName()+<span class="hljs-string">&quot;å¼€å§‹æ‰§è¡Œ&quot;</span>);<br>            &#125;<br>        &#125;);<br><br>        t1.start();<br>        t2.start();<br>        <span class="hljs-keyword">try</span> &#123;<br>            t1.join();<br>            t2.join();<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        System.out.println(Thread.currentThread().getName()+<span class="hljs-string">&quot;æ‰§è¡Œ&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š<strong>ï¼ˆä¸€å®šæ˜¯è¿™ä¸ªé¡ºåºï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Thread-<span class="hljs-number">1</span>å¼€å§‹æ‰§è¡Œ<br>Thread-<span class="hljs-number">0</span>å¼€å§‹æ‰§è¡Œ<br>mainæ‰§è¡Œ<br></code></pre></td></tr></table></figure>

<p><strong>å½“join()æœŸé—´é‡åˆ°ä¸­æ–­æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ</strong></p>
<p>æ˜¯ä¸»çº¿ç¨‹è¢«ä¸­æ–­ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚æœ€å¥½å°†å¼‚å¸¸æŠ›å‡ºç»™å­çº¿ç¨‹ã€‚</p>
<h2 id="6-3-yield"><a href="#6-3-yield" class="headerlink" title="6.3 yield()"></a>6.3 yield()</h2><p>yield()çš„ä½œç”¨æ˜¯<code>è®©æ­¥</code>ï¼Œä¼šè®©çº¿ç¨‹é‡Šæ”¾CPUæ—¶é—´ç‰‡ï¼Œä½†æ˜¯çº¿ç¨‹çš„çŠ¶æ€è¿˜æ˜¯Runnableã€‚</p>
<p>å®ƒèƒ½å¤Ÿè®©å½“å‰çº¿ç¨‹ä»â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œå°±ç»ªçŠ¶æ€â€ï¼Œä»è€Œè®©å…¶ä»–ç­‰å¾…çº¿ç¨‹è·å–æ‰§è¡Œæƒï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åœ¨å½“å‰çº¿ç¨‹è°ƒç”¨yield()ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹å°±ä¸€å®šèƒ½è·å¾—æ‰§è¡Œæƒï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å½“å‰çº¿ç¨‹åˆå›åˆ°â€œè¿è¡ŒçŠ¶æ€â€ç»§ç»­è¿è¡Œ</p>
<h1 id="7-Objectç±»çš„é‡è¦æ–¹æ³•è¯¦è§£"><a href="#7-Objectç±»çš„é‡è¦æ–¹æ³•è¯¦è§£" class="headerlink" title="7.Objectç±»çš„é‡è¦æ–¹æ³•è¯¦è§£"></a>7.Objectç±»çš„é‡è¦æ–¹æ³•è¯¦è§£</h1><p>Objectç±»æ˜¯æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ä»¥ä¸‹çš„æ–¹æ³•ã€‚</p>
<p>wait()å’Œnotify()å¿…é¡»æ”¾åœ¨synchronizedä»£ç å—ä¸­ï¼Œå¦‚æœä¸é€šè¿‡åŒæ­¥å—åŒ…ä½çš„è¯ï¼ŒJVMä¼šæŠ›å‡º<code>IllegalMonitorStateException</code>å¼‚å¸¸ã€‚</p>
<h2 id="7-1-wait"><a href="#7-1-wait" class="headerlink" title="7.1 wait()"></a>7.1 wait()</h2><p><img src="/image/juc/waitSet.png" srcset="/image/beautify/loading.gif" lazyload></p>
<p><strong>æŸä¸ªçº¿ç¨‹å¿…é¡»æ‹¥æœ‰å¯¹è±¡çš„monitoré”æ‰å¯ä»¥è°ƒç”¨wait()æ–¹æ³•</strong>ï¼Œå¹¶ä¸”è¿™ä¸ªçº¿ç¨‹è°ƒç”¨åä¼šè¿›å…¥WAITINGé˜»å¡çŠ¶æ€ã€‚</p>
<p><code>ä¸€æ—¦è°ƒç”¨äº†waitæ–¹æ³•ä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡é”ï¼Œè¯¥çº¿ç¨‹ä¼šè¿›å…¥ä¼‘æ¯å®¤WaitSetï¼Œç­‰å¾…æœ‰äººå”¤é†’</code></p>
<p><strong>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè¢«å”¤é†’ï¼Ÿ</strong></p>
<ol>
<li>å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„notify()æ–¹æ³•ä¸”åˆšå¥½è¢«å”¤é†’çš„æ˜¯æœ¬çº¿ç¨‹ã€‚</li>
<li>å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„notifyAll()æ–¹æ³•</li>
<li>è¿‡äº†wait(long timeout)è§„å®šçš„è¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯å¦‚æœä¼ å…¥0å°±æ˜¯æ°¸ä¹…ç­‰å¾…</li>
<li>çº¿ç¨‹é‡åˆ°ä¸­æ–­ï¼Œå³è°ƒç”¨äº†interrupt()ï¼Œå‘ç”Ÿä¸­æ–­</li>
</ol>
<h2 id="7-2-notify"><a href="#7-2-notify" class="headerlink" title="7.2 notify()"></a>7.2 notify()</h2><p>notify()åªä¼šå”¤é†’å•ä¸ªæ­£åœ¨é˜»å¡çš„çº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šé‡æ–°è½¬ä¸ºå°±ç»ªçŠ¶æ€ï¼Œç­‰å¾…è™šæ‹Ÿæœºåˆ†é…CPUï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ï¼Œ<code>å®ƒåªä¼šé€‰å–å…¶ä¸­ä¸€ä¸ªå»å”¤é†’ï¼Œé€‰å–è§„åˆ™ç”±è™šæ‹Ÿæœºå»å®ç°</code>ã€‚</p>
<h2 id="7-3-notifyAll"><a href="#7-3-notifyAll" class="headerlink" title="7.3 notifyAll()"></a>7.3 notifyAll()</h2><p>ä¼šå”¤é†’æ‰€æœ‰é˜»å¡çš„çº¿ç¨‹ã€‚</p>
<hr>
<p><code>wait()å’Œnotify()ç›¸äº’ä½œç”¨</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">waitAndNotify</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">waitAndNotify1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (object)&#123;<br>                System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;è·å¾—äº†é”&quot;</span>);<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å°†è¦é˜»å¡ï¼Œä¼šé‡Šæ”¾é”&quot;</span>);<br>                    object.wait();<br>                    System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å†æ¬¡è·å¾—äº†é”&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">waitAndNotify2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (object)&#123;<br>                System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å¾—åˆ°äº†é”&quot;</span>);<br>                object.notify();<br>                System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å·²ç»å”¤é†’äº†ä¸€ä¸ªé˜»å¡çº¿ç¨‹ï¼Œå®ƒå¯èƒ½ä¸€ä¼šå°±è·å¾—é”&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">waitAndNotify1</span> <span class="hljs-variable">w1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">waitAndNotify1</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(w1);<br>        thread1.start();<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">100</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-type">waitAndNotify2</span> <span class="hljs-variable">w2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">waitAndNotify2</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(w2);<br>        thread2.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">çº¿ç¨‹Thread-<span class="hljs-number">0</span>è·å¾—äº†é”<br>çº¿ç¨‹Thread-<span class="hljs-number">0</span>å°†è¦é˜»å¡ï¼Œä¼šé‡Šæ”¾é”<br>çº¿ç¨‹Thread-<span class="hljs-number">1</span>å¾—åˆ°äº†é”<br>çº¿ç¨‹Thread-<span class="hljs-number">1</span>å·²ç»å”¤é†’äº†ä¸€ä¸ªé˜»å¡çº¿ç¨‹ï¼Œå®ƒå¯èƒ½ä¸€ä¼šå°±è·å¾—é”<br>çº¿ç¨‹Thread-<span class="hljs-number">0</span>å†æ¬¡è·å¾—äº†é”<br></code></pre></td></tr></table></figure>

<p><code>notify()å’ŒnotifyAll()çš„åŒºåˆ«</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">waitAndNotify</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">object1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">waitAndNotify1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (object1)&#123;<br>                System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;è·å¾—äº†object1é”&quot;</span>);<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å°†è¦é˜»å¡ï¼Œä¼šé‡Šæ”¾object1é”&quot;</span>);<br>                    object1.wait();<br>                    System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å†æ¬¡è·å¾—äº†object1é”ï¼Œå°†è¦è¿è¡Œç»“æŸ&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">waitAndNotify2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (object1)&#123;<br>                System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;è·å¾—äº†object1é”&quot;</span>);<br>                object1.notifyAll();<br>                System.out.println(<span class="hljs-string">&quot;çº¿ç¨‹&quot;</span> + Thread.currentThread().getName() + <span class="hljs-string">&quot;å·²ç»å”¤é†’object1å¯¹è±¡é”çš„å…¨éƒ¨é˜»å¡çº¿ç¨‹&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">waitAndNotify1</span> <span class="hljs-variable">w1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">waitAndNotify1</span>();<br>        <span class="hljs-type">waitAndNotify1</span> <span class="hljs-variable">w3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">waitAndNotify1</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(w1);<br>        thread1.start();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(w3);<br>        thread3.start();<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">100</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-type">waitAndNotify2</span> <span class="hljs-variable">w2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">waitAndNotify2</span>();<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(w2);<br>        thread2.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">çº¿ç¨‹Thread-<span class="hljs-number">0</span>è·å¾—äº†object1é”<br>çº¿ç¨‹Thread-<span class="hljs-number">0</span>å°†è¦é˜»å¡ï¼Œä¼šé‡Šæ”¾object1é”<br>çº¿ç¨‹Thread-<span class="hljs-number">1</span>è·å¾—äº†object1é”<br>çº¿ç¨‹Thread-<span class="hljs-number">1</span>å°†è¦é˜»å¡ï¼Œä¼šé‡Šæ”¾object1é”<br>çº¿ç¨‹Thread-<span class="hljs-number">2</span>è·å¾—äº†object1é”<br>çº¿ç¨‹Thread-<span class="hljs-number">2</span>å·²ç»å”¤é†’object1å¯¹è±¡é”çš„å…¨éƒ¨é˜»å¡çº¿ç¨‹<br>çº¿ç¨‹Thread-<span class="hljs-number">0</span>å†æ¬¡è·å¾—äº†object1é”ï¼Œå°†è¦è¿è¡Œç»“æŸ<br>çº¿ç¨‹Thread-<span class="hljs-number">1</span>å†æ¬¡è·å¾—äº†object1é”ï¼Œå°†è¦è¿è¡Œç»“æŸ<br></code></pre></td></tr></table></figure>

<p>entry setï¼šå…¥å£é›†</p>
<p>wait setï¼šç­‰å¾…é›†</p>
<p><img src="/image/juc/6.png" srcset="/image/beautify/loading.gif" lazyload></p>
<h2 id="7-4-ä½¿ç”¨wait-å’Œnotify-æ¨¡æ‹Ÿç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼"><a href="#7-4-ä½¿ç”¨wait-å’Œnotify-æ¨¡æ‹Ÿç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼" class="headerlink" title="7.4 ä½¿ç”¨wait()å’Œnotify()æ¨¡æ‹Ÿç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼"></a>7.4 ä½¿ç”¨wait()å’Œnotify()æ¨¡æ‹Ÿç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProducerAndCustomer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">BlockedQueue</span> <span class="hljs-variable">queue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BlockedQueue</span>();<br>        <span class="hljs-type">Producer</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Producer</span>(queue);<br>        <span class="hljs-type">Customer</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Customer</span>(queue);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(p);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(c);<br>        t1.start();<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Producer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br><br>    BlockedQueue queue;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Producer</span><span class="hljs-params">(BlockedQueue queue)</span>&#123;<br>        <span class="hljs-built_in">this</span>.queue = queue;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>            queue.in();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Customer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>&#123;<br>    BlockedQueue queue;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Customer</span><span class="hljs-params">(BlockedQueue queue)</span>&#123;<br>        <span class="hljs-built_in">this</span>.queue = queue;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>            queue.take();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BlockedQueue</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxSize;<br>    <span class="hljs-keyword">private</span> List&lt;String&gt; list;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BlockedQueue</span><span class="hljs-params">()</span>&#123;<br>        maxSize = <span class="hljs-number">10</span>;<br>        list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">take</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">while</span>(list.size() == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-built_in">this</span>.wait();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;æ¶ˆè´¹è€…æ‹¿åˆ°ã€&quot;</span>+list.get(<span class="hljs-number">0</span>)+<span class="hljs-string">&quot;ã€‘,ä»“åº“è¿˜å‰©&quot;</span>+(list.size() - <span class="hljs-number">1</span>)+<span class="hljs-string">&quot;ä»¶&quot;</span>);<br>        list.remove(<span class="hljs-number">0</span>);<br>        <span class="hljs-built_in">this</span>.notify();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">in</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">while</span>(list.size() == maxSize)&#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-built_in">this</span>.wait();<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span>  String.valueOf(System.currentTimeMillis());<br>        list.add(num);<br>        System.out.println(<span class="hljs-string">&quot;ç”Ÿäº§è€…ç”Ÿäº§äº†ã€&quot;</span>+num+<span class="hljs-string">&quot;ã€‘ä»“åº“é‡Œæœ‰&quot;</span>+list.size()+<span class="hljs-string">&quot;ä»¶ä¸œè¥¿&quot;</span>);<br>        <span class="hljs-built_in">this</span>.notify();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java">ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">1</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">2</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">3</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">4</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">5</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">6</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">7</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">8</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">9</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">10</span>ä»¶ä¸œè¥¿<br>ä»“åº“æ»¡å•¦..ç”Ÿäº§è€…ç­‰å¾… <br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874352</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">9</span>ä»¶<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874352</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">8</span>ä»¶<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874352</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">7</span>ä»¶<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874352</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">6</span>ä»¶<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">7</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">8</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">9</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874352</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">10</span>ä»¶ä¸œè¥¿<br>ä»“åº“æ»¡å•¦..ç”Ÿäº§è€…ç­‰å¾… <br>    .........<br>ä»“åº“ç©ºå•¦..æ¶ˆè´¹è€…ç­‰å¾…<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874362</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">1</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874362</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">2</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874362</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">3</span>ä»¶ä¸œè¥¿<br>ç”Ÿäº§è€…ç”Ÿäº§äº†ã€<span class="hljs-number">1647305874362</span>ã€‘ä»“åº“é‡Œæœ‰<span class="hljs-number">4</span>ä»¶ä¸œè¥¿<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874362</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">3</span>ä»¶<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874362</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">2</span>ä»¶<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874362</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">1</span>ä»¶<br>æ¶ˆè´¹è€…æ‹¿åˆ°ã€<span class="hljs-number">1647305874362</span>ã€‘,ä»“åº“è¿˜å‰©<span class="hljs-number">0</span>ä»¶<br>ä»“åº“ç©ºå•¦..æ¶ˆè´¹è€…ç­‰å¾…<br>    ....<br></code></pre></td></tr></table></figure>

<h1 id="8-wait-ã€notify-ã€sleep-çš„å¼‚åŒ"><a href="#8-wait-ã€notify-ã€sleep-çš„å¼‚åŒ" class="headerlink" title="8.wait()ã€notify()ã€sleep()çš„å¼‚åŒ"></a>8.wait()ã€notify()ã€sleep()çš„å¼‚åŒ</h1><ul>
<li>ç›¸åŒç‚¹ï¼šé˜»å¡ã€å“åº”ä¸­æ–­ã€æ¸…é™¤ä¸­æ–­æ ‡å¿—ä½</li>
<li>ä¸åŒç‚¹ï¼šæ˜¯å¦è¢«åŒ…æ‹¬åœ¨åŒæ­¥æ–¹æ³•ä¸­ã€æ˜¯å¦é‡Šæ”¾é”ã€æ˜¯å¦å¿…é¡»æŒ‡å®šæ—¶é—´ã€æ‰€å±ç±»æ˜¯å“ªä¸ª</li>
</ul>
<h1 id="9-çº¿ç¨‹çš„å„ä¸ªå±æ€§"><a href="#9-çº¿ç¨‹çš„å„ä¸ªå±æ€§" class="headerlink" title="9.çº¿ç¨‹çš„å„ä¸ªå±æ€§"></a>9.çº¿ç¨‹çš„å„ä¸ªå±æ€§</h1><p><img src="/image/juc/thread.png" srcset="/image/beautify/loading.gif" lazyload></p>
<ol>
<li><code>çº¿ç¨‹id</code>çš„é‚£ä¸ªå±æ€§åˆå§‹å€¼æ˜¯0ï¼Œä½†æ˜¯è·å–å‰ä¼šè¢«åŠ 1ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå°±æ˜¯ä¸»çº¿ç¨‹mainçš„idæ˜¯1ï¼Œåé¢çš„å­çº¿ç¨‹ä¾æ¬¡å¢åŠ ã€‚</li>
<li><code>çº¿ç¨‹åå­—</code>å¯ä»¥é€šè¿‡Threadç±»ä¸­çš„setNameæ–¹æ³•æ¥è®¾ç½®ï¼Œä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œä½¿ç”¨é»˜è®¤çš„Thread-numberï¼Œnumberä»0å¼€å§‹ï¼Œæ¯æ¬¡åŠ 1</li>
<li><code>å®ˆæŠ¤çº¿ç¨‹</code>ï¼šæœåŠ¡äºç”¨æˆ·çº¿ç¨‹çš„ï¼Œä¸å½±å“jvmçš„é€€å‡ºã€‚</li>
<li><code>çº¿ç¨‹ä¼˜å…ˆçº§</code>ï¼šjavaè™šæ‹Ÿæœºä¸­ï¼Œæœ‰10ä¸ªçº§åˆ«ï¼Œé»˜è®¤æ˜¯5ã€‚ä¸€èˆ¬æ˜¯å°†javaè™šæ‹Ÿæœºä¸­çš„ä¼˜å…ˆçº§æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿä¸Šçš„ä¼˜å…ˆçº§ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿä¼˜å…ˆçº§èŒƒå›´çº§åˆ«å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸è¦éšæ„æ”¹å˜ä¼˜å…ˆçº§ï¼Œå¦åˆ™å¯¼è‡´æ˜ å°„åçš„ä¼˜å…ˆçº§ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚ä¼˜å…ˆçº§ä¹Ÿå¯èƒ½ä¼šè¢«æ“ä½œç³»ç»Ÿæ”¹å˜</li>
</ol>
<h1 id="10-çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#10-çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="10.çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>10.çº¿ç¨‹å®‰å…¨é—®é¢˜</h1><h2 id="10-1-å…±äº«çš„æˆå‘˜å˜é‡å’Œé™æ€å˜é‡"><a href="#10-1-å…±äº«çš„æˆå‘˜å˜é‡å’Œé™æ€å˜é‡" class="headerlink" title="10.1 å…±äº«çš„æˆå‘˜å˜é‡å’Œé™æ€å˜é‡"></a>10.1 å…±äº«çš„æˆå‘˜å˜é‡å’Œé™æ€å˜é‡</h2><p>æ ¹æ®å®ƒä»¬çš„çŠ¶æ€æ˜¯å¦èƒ½å¤Ÿæ”¹å˜ï¼Œåˆ†ä¸¤ç§æƒ…å†µ</p>
<ul>
<li>å¦‚æœåªæœ‰è¯»æ“ä½œï¼Œåˆ™çº¿ç¨‹å®‰å…¨ </li>
<li>å¦‚æœæœ‰è¯»å†™æ“ä½œï¼Œåˆ™è¿™æ®µä»£ç æ˜¯<strong>ä¸´ç•ŒåŒº</strong>ï¼Œéœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨</li>
</ul>
<p>ä¸€æ®µä»£ç å—å†…å¦‚æœå­˜åœ¨å¯¹å…±äº«èµ„æºçš„å¤šçº¿ç¨‹è¯»å†™æ“ä½œï¼Œç§°è¿™æ®µä»£ç å—ä¸º<strong>ä¸´ç•ŒåŒº</strong></p>
<h2 id="10-2-æ­»é”ã€æ´»é”ã€é¥¥é¥¿"><a href="#10-2-æ­»é”ã€æ´»é”ã€é¥¥é¥¿" class="headerlink" title="10.2 æ­»é”ã€æ´»é”ã€é¥¥é¥¿"></a>10.2 æ­»é”ã€æ´»é”ã€é¥¥é¥¿</h2><p><code>æ­»é”</code>ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½ä¸æ”¾å¼ƒè‡ªå·±çš„é”ï¼ŒåŒæ—¶ä¹ŸæœŸæœ›å¾—åˆ°å¯¹æ–¹çš„é”ã€‚</p>
<p>æ­»é”å¯ä»¥é€šè¿‡çº¿ç¨‹æŒ‰ç…§ç›¸åŒçš„é¡ºåºè·å–é”æ¥è§£å†³ï¼Œä½†æ˜¯è¿™æ ·ä¼šäº§ç”Ÿé¥¥é¥¿ã€‚</p>
<p><strong>æ­»é”çš„ä¾‹å­</strong>ï¼Œæ³¨æ„ä¸€ä¸‹ï¼Œobject1å’Œobject2å¿…é¡»æ˜¯staticçš„å˜é‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">dead</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">//å¦‚æœæœ‰æ•°æ®éœ€è¦è¢«å…±äº«ç»™æ‰€æœ‰å¯¹è±¡ä½¿ç”¨æ—¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨staticä¿®é¥°ã€‚</span><br>    <span class="hljs-comment">//å› ä¸ºé™æ€æˆå‘˜å˜é‡æ˜¯å­˜å‚¨æ–¹æ³• åŒºå†…å­˜ä¸­ï¼Œè€Œä¸”åªä¼šå­˜åœ¨ä¸€ä»½æ•°æ®ã€‚</span><br>    <span class="hljs-comment">//éé™æ€çš„æˆå‘˜å˜é‡æ˜¯å­˜å‚¨åœ¨å †å†…å­˜ä¸­ï¼Œæœ‰nä¸ªå¯¹è±¡å°±æœ‰nä»½æ•°æ®ã€‚</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">object1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">object2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(flag);<br>        <span class="hljs-keyword">if</span>(flag == <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">synchronized</span> (object1)&#123;<br>                System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;æ‹¿åˆ°äº†object1&quot;</span>);<br>                <span class="hljs-keyword">try</span> &#123;<br>                    Thread.sleep(<span class="hljs-number">3000</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>                <span class="hljs-keyword">synchronized</span> (object2)&#123;<br>                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;æ‹¿åˆ°äº†object2&quot;</span>);<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(flag == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">synchronized</span> (object2)&#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;æ‹¿åˆ°äº†object2&quot;</span>);<br>                    Thread.sleep(<span class="hljs-number">500</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>                <span class="hljs-keyword">synchronized</span> (object1)&#123;<br>                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;æ‹¿åˆ°äº†object1&quot;</span>);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>   &#123;<br>        <span class="hljs-type">dead</span> <span class="hljs-variable">d1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">dead</span>();<br>        <span class="hljs-type">dead</span> <span class="hljs-variable">d2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">dead</span>();<br>        d1.flag = <span class="hljs-number">0</span>;<br>        d2.flag = <span class="hljs-number">1</span>;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(d1);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(d2);<br>        thread1.start();<br>        thread2.start();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>æ­»é”çš„ä¾‹å­ï¼š<strong>å“²å­¦å®¶å°±é¤é—®é¢˜</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Philosopher</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br><br>    chopsticks left;<br>    chopsticks right;<br>    String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Philosopher</span><span class="hljs-params">(String name,chopsticks left,chopsticks right)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.right = right;<br>        <span class="hljs-built_in">this</span>.left = left;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>            <span class="hljs-keyword">synchronized</span> (left)&#123;<br>                <span class="hljs-keyword">synchronized</span> (right)&#123;<br>                    eat();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(name + <span class="hljs-string">&quot;æ‹¿ä¸Šç­·å­&quot;</span> + left.name + <span class="hljs-string">&quot;,&quot;</span> + right.name + <span class="hljs-string">&quot;å¼€å§‹åƒé¥­..&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            Thread.sleep(<span class="hljs-number">100</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        System.out.println(name + <span class="hljs-string">&quot;æ”¾ä¸‹ç­·å­&quot;</span> + left.name + <span class="hljs-string">&quot;,&quot;</span> + right.name + <span class="hljs-string">&quot;å¼€å§‹æ€è€ƒ..&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">chopsticks</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">chopsticks</span>(<span class="hljs-string">&quot;c1&quot;</span>);<br>        <span class="hljs-type">chopsticks</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">chopsticks</span>(<span class="hljs-string">&quot;c2&quot;</span>);<br>        <span class="hljs-type">chopsticks</span> <span class="hljs-variable">c3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">chopsticks</span>(<span class="hljs-string">&quot;c3&quot;</span>);<br>        <span class="hljs-type">chopsticks</span> <span class="hljs-variable">c4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">chopsticks</span>(<span class="hljs-string">&quot;c4&quot;</span>);<br>        <span class="hljs-type">chopsticks</span> <span class="hljs-variable">c5</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">chopsticks</span>(<span class="hljs-string">&quot;c5&quot;</span>);<br>        <span class="hljs-type">Philosopher</span> <span class="hljs-variable">p1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Philosopher</span>(<span class="hljs-string">&quot;å“²å­¦å®¶1&quot;</span>,c1,c2);<br>        <span class="hljs-type">Philosopher</span> <span class="hljs-variable">p2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Philosopher</span>(<span class="hljs-string">&quot;å“²å­¦å®¶2&quot;</span>,c2,c3);<br>        <span class="hljs-type">Philosopher</span> <span class="hljs-variable">p3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Philosopher</span>(<span class="hljs-string">&quot;å“²å­¦å®¶3&quot;</span>,c3,c4);<br>        <span class="hljs-type">Philosopher</span> <span class="hljs-variable">p4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Philosopher</span>(<span class="hljs-string">&quot;å“²å­¦å®¶4&quot;</span>,c4,c5);<br>        <span class="hljs-type">Philosopher</span> <span class="hljs-variable">p5</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Philosopher</span>(<span class="hljs-string">&quot;å“²å­¦å®¶5&quot;</span>,c5,c1);<br>        p1.start();<br>        p2.start();<br>        p3.start();<br>        p4.start();<br>        p5.start();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span>  <span class="hljs-title class_">chopsticks</span>&#123;<br>    String name;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">chopsticks</span><span class="hljs-params">(String name)</span>&#123;<br>        <span class="hljs-built_in">this</span>.name  = name;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">å“²å­¦å®¶<span class="hljs-number">3</span>æ‹¿ä¸Šç­·å­c3,c4å¼€å§‹åƒé¥­..<br>å“²å­¦å®¶<span class="hljs-number">1</span>æ‹¿ä¸Šç­·å­c1,c2å¼€å§‹åƒé¥­..<br>å“²å­¦å®¶<span class="hljs-number">3</span>æ”¾ä¸‹ç­·å­c3,c4å¼€å§‹æ€è€ƒ..<br>å“²å­¦å®¶<span class="hljs-number">3</span>æ‹¿ä¸Šç­·å­c3,c4å¼€å§‹åƒé¥­..<br>å“²å­¦å®¶<span class="hljs-number">1</span>æ”¾ä¸‹ç­·å­c1,c2å¼€å§‹æ€è€ƒ..<br>å“²å­¦å®¶<span class="hljs-number">5</span>æ‹¿ä¸Šç­·å­c5,c1å¼€å§‹åƒé¥­..<br>å“²å­¦å®¶<span class="hljs-number">5</span>æ”¾ä¸‹ç­·å­c5,c1å¼€å§‹æ€è€ƒ..<br>å“²å­¦å®¶<span class="hljs-number">5</span>æ‹¿ä¸Šç­·å­c5,c1å¼€å§‹åƒé¥­..<br>å“²å­¦å®¶<span class="hljs-number">3</span>æ”¾ä¸‹ç­·å­c3,c4å¼€å§‹æ€è€ƒ..<br>å“²å­¦å®¶<span class="hljs-number">5</span>æ”¾ä¸‹ç­·å­c5,c1å¼€å§‹æ€è€ƒ..<br></code></pre></td></tr></table></figure>

<p>æ­¤æ—¶å·²ç»å‘ç”Ÿäº†æ­»é”ï¼Œçº¿ç¨‹å¤„äºBLOCKEDçŠ¶æ€ã€‚</p>
<h2 id="10-3-æ´»é”"><a href="#10-3-æ´»é”" class="headerlink" title="10.3 æ´»é”"></a>10.3 æ´»é”</h2><p><code>æ´»é”</code>ï¼šä¸¤ä¸ªçº¿ç¨‹äº’ç›¸æ”¹å˜å¯¹æ–¹çš„ç»“æŸæ¡ä»¶ï¼Œæœ€ç»ˆè°ä¹Ÿæ— æ³•ç»“æŸã€‚éƒ½å¤„äºRunnableçŠ¶æ€ã€‚</p>
<p>æ¯”å¦‚å½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ”¹å˜ä¸€ä¸ªå…±äº«å˜é‡ï¼Œå®ƒçš„åˆå§‹å€¼æ˜¯10ï¼Œå¹¶ä¸”çº¿ç¨‹1ç»“æŸè¿è¡Œçš„æ¡ä»¶æ˜¯è¿™ä¸ªå˜é‡å¤§äº0ï¼Œçº¿ç¨‹2è¿è¡Œçš„ç»“æŸæ¡ä»¶æ˜¯è¿™ä¸ªå˜é‡å°äº20ï¼Œ</p>
<h2 id="10-4-é¥¥é¥¿"><a href="#10-4-é¥¥é¥¿" class="headerlink" title="10.4 é¥¥é¥¿"></a>10.4 é¥¥é¥¿</h2><p><code>é¥¥é¥¿</code>ï¼šä¸€ä¸ªçº¿ç¨‹ç”±äºä¼˜å…ˆçº§å¤ªä½ï¼Œå§‹ç»ˆå¾—ä¸åˆ°CPUè°ƒåº¦æ‰§è¡Œï¼Œä¹Ÿä¸èƒ½ç»“æŸã€‚</p>
<h2 id="10-5-å¯¹è±¡å‘å¸ƒå’Œåˆå§‹åŒ–"><a href="#10-5-å¯¹è±¡å‘å¸ƒå’Œåˆå§‹åŒ–" class="headerlink" title="10.5 å¯¹è±¡å‘å¸ƒå’Œåˆå§‹åŒ–"></a>10.5 å¯¹è±¡å‘å¸ƒå’Œåˆå§‹åŒ–</h2><p>å‘å¸ƒæ˜¯è®©å…¶ä»–ç±»å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªå˜é‡ï¼Œå°±æ˜¯æŠŠè¿™ä¸ªå˜é‡å‘å¸ƒã€‚</p>
<p>é€¸å‡ºæ˜¯ä¸è®©å…¶ä»–ç±»å¯è§çš„å˜é‡è¢«å…¶ä»–ç±»è®¿é—®ï¼Œæˆ–è€…æ”¹å˜å®ƒçš„å€¼ã€‚</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/JUC/" class="category-chain-item">JUC</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%80%BB%E7%BB%93/" class="print-no-link">#æ€»ç»“</a>
      
        <a href="/tags/juc/" class="print-no-link">#juc</a>
      
        <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="print-no-link">#å¹¶å‘ç¼–ç¨‹</a>
      
        <a href="/tags/%E7%BA%BF%E7%A8%8B/" class="print-no-link">#çº¿ç¨‹</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Javaå¤šçº¿ç¨‹-çº¿ç¨‹æ ¸å¿ƒåŸºç¡€</div>
      <div>https://vickkkyz.fun/2022/03/24/Java/JUC/çº¿ç¨‹å…«å¤§æ ¸å¿ƒåŸºç¡€/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Vickkkyz</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´3æœˆ24æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/03/24/Java/JUC/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="Javaå¤šçº¿ç¨‹-è‡ªå®šä¹‰çº¿ç¨‹æ± ">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Javaå¤šçº¿ç¨‹-è‡ªå®šä¹‰çº¿ç¨‹æ± </span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/03/24/Java/JUC/%E4%BA%A4%E6%9B%BF%E5%92%8C%E9%A1%BA%E5%BA%8F%E8%BE%93%E5%87%BA/" title="Javaå¤šçº¿ç¨‹-é¡ºåº&amp;äº¤æ›¿è¾“å‡º">
                        <span class="hidden-mobile">Javaå¤šçº¿ç¨‹-é¡ºåº&amp;äº¤æ›¿è¾“å‡º</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
<!-- Load TweenLite --> <script src="https://cdn.jsdelivr.net/npm/greensock@1.20.2/dist/TweenLite.js"></script>
<!-- Copyrighted cubism SDK --> <script src="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"></script> <!-- Load Pixi (dependency for cubism 2/4 integrated loader) --> <script src="https://cdn.jsdelivr.net/npm/pixi.js@5.3.6/dist/pixi.min.js"></script> <!-- Load cubism 4 integrated loader --> <script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display@0.3.1/dist/cubism4.min.js"></script>
<!-- Load pio and alternative loader --> <link href="https://cdn.jsdelivr.net/gh/vickkkyz/vickkkyz.github.io@2.0/css/pio.css" rel="stylesheet" type="text/css"/> <script src="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/pio.js"></script> <script src="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/pio_sdk4.js"></script> <script src="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/load.js"></script>
<!-- é¡µè„šæ·»åŠ ç½‘ç«™è¿è¡Œæ—¶é—´ --> <div> <span id="timeDate">è½½å…¥å¤©æ•°...</span> <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span> <script src="/js/duration.js"></script> </div> <a href="https://icp.gov.moe/?keyword=20249336" target="_blank">èŒICPå¤‡20249336å·</a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="https://cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>



<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
